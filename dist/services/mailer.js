"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,n,t){return n&&e(r.prototype,n),t&&e(r,t),r}}();Object.defineProperty(exports,"__esModule",{value:!0});var _googleapis=require("googleapis"),_googleapis2=_interopRequireDefault(_googleapis),_config=require("./config"),_config2=_interopRequireDefault(_config),_logger=require("./logger"),_logger2=_interopRequireDefault(_logger),_merge=require("lodash/object/merge"),_merge2=_interopRequireDefault(_merge),_nodemailer=require("nodemailer"),_nodemailer2=_interopRequireDefault(_nodemailer),_nodemailerSmtpTransport=require("nodemailer-smtp-transport"),_nodemailerSmtpTransport2=_interopRequireDefault(_nodemailerSmtpTransport),MailerService=function(){function e(r){_classCallCheck(this,e),this.config=r}return _createClass(e,[{key:"send",value:function(e,r,n,t){var a=arguments.length<=4||void 0===arguments[4]?function(){}:arguments[4],o=this.config,i=(0,_nodemailerSmtpTransport2["default"])(o.transport),l=_nodemailer2["default"].createTransport(i),u={};e&&(u.from=e),r&&(u.to=r),n&&(u.subject=n),t&&(u.text=t);var s=(0,_merge2["default"])({},o.formOptions,u);l.sendMail(s,function(e,r){e?_logger2["default"].error(e):(_logger2["default"].debug("New Mail for upload was send"),_logger2["default"].debug(r)),a(e,r)})}},{key:"notifyNewUpload",value:function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],r=arguments.length<=1||void 0===arguments[1]?function(){}:arguments[1],n=e.description,t=e.name,a="\n      Description: "+n+",\n      Name: "+t+"\n    ";this.send(null,null,"New foto upload",a,r)}}]),e}(),instance=null;instance||(instance=new MailerService(_config2["default"].mailer)),exports["default"]=instance;